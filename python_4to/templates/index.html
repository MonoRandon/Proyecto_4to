<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Canvas IA de Planos</title>
    <link rel="stylesheet" href="static/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

</head>
<body class="container py-4">

    <h1 class="mb-4">Canvas de Planos con IA</h1>

    <form action="/analizar-plano" method="POST" enctype="multipart/form-data" class="mb-3">
        <div class="input-group">
            <input type="file" name="plano" class="form-control" accept="image/*" required>
            <button class="btn btn-primary" type="submit">Subir y Analizar</button>
        </div>
    </form>

    <div class="row">
        <!-- Área de dibujo / Canvas -->
        <div class="col-md-8">
            <div id="canvas-area">
                {% if imagen %}
                    <img src="{{ imagen }}">
                {% else %}
                    <p>Sube un plano para verlo aquí</p>
                {% endif %}
            </div>

            {% if analisis %}
                <h4>Análisis del plano</h4>
                <pre>{{ analisis }}</pre>
            {% endif %}

            {% if sugerencias %}
                <h4>Sugerencias de la IA</h4>
                <pre>{{ sugerencias }}</pre>
            {% endif %}
        </div>

        <!-- Lista de archivos -->
        <div class="col-md-4">
            <div class="sidebar">
                <h5>Planos guardados</h5>
                {% for archivo in archivos %}
                    <div class="file-item" onclick="window.location.href='/ver/{{ archivo }}'">
                        {{ archivo }}
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="visor-container">
  <h2>Plano actual:</h2>
  {% if imagen %}
  <div class="canvas-visor">
    <img id="planoImagen" src="{{ url_for('static', filename='plano_corregido.png') }}" alt="Plano corregido">
  </div>
  {% else %}
  <p>No se ha seleccionado ningún plano.</p>
  {% endif %}
</div>

<div class="lista-archivos">
  <h3>Archivos disponibles:</h3>
  <ul>
    {% for archivo in archivos %}
    <li>
      <a href="{{ url_for('ver_archivo', nombre_archivo=archivo) }}">{{ archivo }}</a>
    </li>
    {% endfor %}
  </ul>
</div>

</body>
</html>
